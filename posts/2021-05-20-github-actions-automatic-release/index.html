<!doctype html><html lang=en-us>
<head>
<link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<title> Automatic release drafting to Github Releases | DOVH</title>
<link rel=canonical href=https://dovh.cz/posts/2021-05-20-github-actions-automatic-release/>
<meta name=description content="Random stuff I'm interested in and feel it's worth writing about.">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="all,follow">
<meta name=googlebot content="index,follow,snippet,archive">
<meta property="og:title" content="Automatic release drafting to Github Releases">
<meta property="og:description" content="Generate draft release on GitHub with GitHub Actions I was trying to find a way to do GitHub releases with GitHub Actions or GitLab CI. When I happen to find semantic-release project. One of the benefits of GitHub Actions is that the majority of its users open source their workflows by default. I was able to kick start my workflow for keeping up with releases thanks to code from benmvp, a GitHub user and keynote speaker.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://dovh.cz/posts/2021-05-20-github-actions-automatic-release/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-05-20T09:00:00+00:00">
<meta property="article:modified_time" content="2021-05-20T09:00:00+00:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Automatic release drafting to Github Releases">
<meta name=twitter:description content="Generate draft release on GitHub with GitHub Actions I was trying to find a way to do GitHub releases with GitHub Actions or GitLab CI. When I happen to find semantic-release project. One of the benefits of GitHub Actions is that the majority of its users open source their workflows by default. I was able to kick start my workflow for keeping up with releases thanks to code from benmvp, a GitHub user and keynote speaker.">
<link rel=stylesheet href=https://dovh.cz/css/styles.c05d68261bf086a9d7713c4f8a6215a3601608e267a816a7ee58f139b3d1aae51222aae2081c8e0c6bd35e1334773b7a16283022f31f92afd93bb37e5e822e66.css integrity="sha512-wF1oJhvwhqnXcTxPimIVo2AWCOJnqBan7ljxObPRquUSIqriCByODGvTXhM0dzt6FigwIvMfkq/ZO7N+XoIuZg=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]-->
<link rel=icon type=image/png href=https://dovh.cz/images/favicon.ico>
</head>
<body class="max-width mx-auto px3 ltr">
<div class="content index py4">
<div id=header-post>
<a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick="$('html, body').animate({scrollTop:0},'fast')" style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu>
<span id=nav>
<ul>
<li><a href=/>Home</a></li>
<li><a href=/about>About</a></li>
<li><a href=/posts>Blog</a></li>
<li><a href=/tags>Topics</a></li>
</ul>
</span>
<br>
<span id=actions>
<ul>
<li>
<a class=icon href=https://dovh.cz/posts/2021-05-20-github-actions-basics/ aria-label=Previous>
<i class="fas fa-chevron-left" aria-hidden=true onmouseover="$('#i-prev').toggle()" onmouseout="$('#i-prev').toggle()"></i>
</a>
</li>
<li>
<a class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast')" aria-label="Top of Page">
<i class="fas fa-chevron-up" aria-hidden=true onmouseover="$('#i-top').toggle()" onmouseout="$('#i-top').toggle()"></i>
</a>
</li>
<li>
<a class=icon href=# aria-label=Share>
<i class="fas fa-share-alt" aria-hidden=true onmouseover="$('#i-share').toggle()" onmouseout="$('#i-share').toggle()" onclick="return $('#share').toggle(),!1"></i>
</a>
</li>
</ul>
<span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span>
</span>
<br>
<div id=share style=display:none>
<ul>
<li>
<a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fdovh.cz%2fposts%2f2021-05-20-github-actions-automatic-release%2f" aria-label=Facebook>
<i class="fab fa-facebook" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://twitter.com/share?url=https%3a%2f%2fdovh.cz%2fposts%2f2021-05-20-github-actions-automatic-release%2f&text=Automatic%20release%20drafting%20to%20Github%20Releases" aria-label=Twitter>
<i class="fab fa-twitter" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fdovh.cz%2fposts%2f2021-05-20-github-actions-automatic-release%2f&title=Automatic%20release%20drafting%20to%20Github%20Releases" aria-label=Linkedin>
<i class="fab fa-linkedin" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fdovh.cz%2fposts%2f2021-05-20-github-actions-automatic-release%2f&is_video=false&description=Automatic%20release%20drafting%20to%20Github%20Releases" aria-label=Pinterest>
<i class="fab fa-pinterest" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="mailto:?subject=Automatic%20release%20drafting%20to%20Github%20Releases&body=Check out this article: https%3a%2f%2fdovh.cz%2fposts%2f2021-05-20-github-actions-automatic-release%2f" aria-label=Email>
<i class="fas fa-envelope" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fdovh.cz%2fposts%2f2021-05-20-github-actions-automatic-release%2f&title=Automatic%20release%20drafting%20to%20Github%20Releases" aria-label=Pocket>
<i class="fab fa-get-pocket" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fdovh.cz%2fposts%2f2021-05-20-github-actions-automatic-release%2f&title=Automatic%20release%20drafting%20to%20Github%20Releases" aria-label=reddit>
<i class="fab fa-reddit" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fdovh.cz%2fposts%2f2021-05-20-github-actions-automatic-release%2f&name=Automatic%20release%20drafting%20to%20Github%20Releases&description=Generate%20draft%20release%20on%20GitHub%20with%20GitHub%20Actions%20I%20was%20trying%20to%20find%20a%20way%20to%20do%20GitHub%20releases%20with%20GitHub%20Actions%20or%20GitLab%20CI.%20When%20I%20happen%20to%20find%20semantic-release%20project.%20One%20of%20the%20benefits%20of%20GitHub%20Actions%20is%20that%20the%20majority%20of%20its%20users%20open%20source%20their%20workflows%20by%20default.%20I%20was%20able%20to%20kick%20start%20my%20workflow%20for%20keeping%20up%20with%20releases%20thanks%20to%20code%20from%20benmvp%2c%20a%20GitHub%20user%20and%20keynote%20speaker." aria-label=Tumblr>
<i class="fab fa-tumblr" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fdovh.cz%2fposts%2f2021-05-20-github-actions-automatic-release%2f&t=Automatic%20release%20drafting%20to%20Github%20Releases" aria-label="Hacker News">
<i class="fab fa-hacker-news" aria-hidden=true></i>
</a>
</li>
</ul>
</div>
<div id=toc>
<nav id=TableOfContents>
<ul>
<li><a href=#generate-draft-release-on-github-with-github-actions>Generate draft release on GitHub with GitHub Actions</a>
<ul>
<li><a href=#do-the-github-release-from-gitlab-ci-pipline>Do the Github release from Gitlab CI pipline.</a></li>
</ul>
</li>
</ul>
</nav>
</div>
</span>
</div>
<article class=post itemscope itemtype=http://schema.org/BlogPosting>
<header>
<h1 class=posttitle itemprop="name headline">
Automatic release drafting to Github Releases
</h1>
<div class=meta>
<span class=author itemprop=author itemscope itemtype=http://schema.org/Person>
<span itemprop=name>
DOVH
</span>
</span>
<div class=postdate>
<time datetime="2021-05-20 09:00:00 +0000 UTC" itemprop=datePublished>2021-05-20</time>
</div>
<div class=article-read-time>
<i class="far fa-clock"></i>
2 minute read
</div>
<div class=article-category>
<i class="fas fa-archive"></i>
<a class=category-link href=/categories/automation>automation</a>
</div>
<div class=article-tag>
<i class="fas fa-tag"></i>
<a class=tag-link href=/tags/github rel=tag>github</a>
</div>
</div>
</header>
<div class=content itemprop=articleBody>
<h2 id=generate-draft-release-on-github-with-github-actions>Generate draft release on GitHub with GitHub Actions</h2>
<p>I was trying to find a way to do GitHub releases with GitHub Actions or GitLab CI. When I happen to find semantic-release project. One of the benefits of GitHub Actions is that the majority of its users open source their workflows by default. I was able to kick start my workflow for keeping up with releases thanks to code from benmvp, a GitHub user and keynote speaker. This was a huge help with setting up our CI to create drafted releases directly to GitHub Release page.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>name</span>: <span style=color:#ae81ff>Release</span>

<span style=color:#f92672>on</span>:
  <span style=color:#f92672>push</span>:
    <span style=color:#f92672>branches</span>:
      - <span style=color:#ae81ff>master</span>

<span style=color:#f92672>jobs</span>:
  <span style=color:#f92672>main</span>:
    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Draft Release</span>
    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>

    <span style=color:#f92672>steps</span>:
      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Checkout</span>
        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v1</span>

      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Use Node v12</span>
        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/setup-node@v1</span>
        <span style=color:#f92672>with</span>:
          <span style=color:#f92672>node-version</span>: <span style=color:#ae81ff>12</span>

      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Install dependencies</span>
        <span style=color:#f92672>run</span>: <span style=color:#ae81ff>npm ci</span>

      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Double check unit tests</span>
        <span style=color:#f92672>run</span>: <span style=color:#ae81ff>npm test</span>
        <span style=color:#f92672>env</span>:
          <span style=color:#f92672>CI</span>: <span style=color:#66d9ef>true</span>

      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Double check integration tests</span>
        <span style=color:#f92672>run</span>: <span style=color:#ae81ff>npm run integrate</span>
        <span style=color:#f92672>env</span>:
          <span style=color:#f92672>CI</span>: <span style=color:#66d9ef>true</span>

      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Build package</span>
        <span style=color:#f92672>run</span>: <span style=color:#ae81ff>npm run build</span>

      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Publish new version to GitHub Release</span>
        <span style=color:#f92672>env</span>:
          <span style=color:#f92672>GITHUB_TOKEN</span>: <span style=color:#ae81ff>${{ secrets.GITHUB_TOKEN }}</span>
        <span style=color:#f92672>run</span>: <span style=color:#ae81ff>npx semantic-release</span>
</code></pre></div><p>If you take a look at that workflow, you can see at the bottom that he’s using the npx command to leverage semantic-release directly with its CLI. GitHub Actions workflows allow you to run set runner environments and run shell commands. That solves the one problem, but I’m a big fan of actually automating my changelog as well.</p>
<p>I leverage actions to generate my release notes for projects. I discovered that it provides a changelog and bumps the version number in package.json file.</p>
<h3 id=do-the-github-release-from-gitlab-ci-pipline>Do the Github release from Gitlab CI pipline.</h3>
<p>We can also use a lot simpler and more universal solution if we go with GitHub Cli tool. For this, to work we will need to create a base Docker image where this job of ours will run. You will also need to set GitlabCI environment variable &ldquo;GITHUB_TOKEN&rdquo; with your private token with access to full <code>repo:</code> and <code>org:read</code></p>
<p>After this, you should be able to run the job and it will create a draft of your release. If you want to attach any files to the release simply specify the path at the end of &ldquo;gh release&rdquo; line with <code>./</code> if stored in your repository root folder.</p>
<p>Gitlab CI example job.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>script</span>:
    - <span style=color:#ae81ff>gh config set prompt disabled</span>
    - <span style=color:#ae81ff>VERSION=$(jq -r .version path/to_your_version_file/package.json)</span>
    - <span style=color:#ae81ff>gh release create --repo OWNER/PROJECTNAME --draft v${VERSION}  --title &#34;v${VERSION}&#34;</span>
</code></pre></div><p>Tool needed inside dokcer file are <a href=https://stedolan.github.io/jq/>jq</a> and <a href=https://cli.github.com/>GIthubCLI</a></p>
</div>
</article>
<div id=footer-post-container>
<div id=footer-post>
<div id=nav-footer style=display:none>
<ul>
<li><a href=/>Home</a></li>
<li><a href=/about>About</a></li>
<li><a href=/posts>Blog</a></li>
<li><a href=/tags>Topics</a></li>
</ul>
</div>
<div id=toc-footer style=display:none>
<nav id=TableOfContents>
<ul>
<li><a href=#generate-draft-release-on-github-with-github-actions>Generate draft release on GitHub with GitHub Actions</a>
<ul>
<li><a href=#do-the-github-release-from-gitlab-ci-pipline>Do the Github release from Gitlab CI pipline.</a></li>
</ul>
</li>
</ul>
</nav>
</div>
<div id=share-footer style=display:none>
<ul>
<li>
<a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fdovh.cz%2fposts%2f2021-05-20-github-actions-automatic-release%2f" aria-label=Facebook>
<i class="fab fa-facebook fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://twitter.com/share?url=https%3a%2f%2fdovh.cz%2fposts%2f2021-05-20-github-actions-automatic-release%2f&text=Automatic%20release%20drafting%20to%20Github%20Releases" aria-label=Twitter>
<i class="fab fa-twitter fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fdovh.cz%2fposts%2f2021-05-20-github-actions-automatic-release%2f&title=Automatic%20release%20drafting%20to%20Github%20Releases" aria-label=Linkedin>
<i class="fab fa-linkedin fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fdovh.cz%2fposts%2f2021-05-20-github-actions-automatic-release%2f&is_video=false&description=Automatic%20release%20drafting%20to%20Github%20Releases" aria-label=Pinterest>
<i class="fab fa-pinterest fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="mailto:?subject=Automatic%20release%20drafting%20to%20Github%20Releases&body=Check out this article: https%3a%2f%2fdovh.cz%2fposts%2f2021-05-20-github-actions-automatic-release%2f" aria-label=Email>
<i class="fas fa-envelope fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fdovh.cz%2fposts%2f2021-05-20-github-actions-automatic-release%2f&title=Automatic%20release%20drafting%20to%20Github%20Releases" aria-label=Pocket>
<i class="fab fa-get-pocket fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fdovh.cz%2fposts%2f2021-05-20-github-actions-automatic-release%2f&title=Automatic%20release%20drafting%20to%20Github%20Releases" aria-label=reddit>
<i class="fab fa-reddit fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fdovh.cz%2fposts%2f2021-05-20-github-actions-automatic-release%2f&name=Automatic%20release%20drafting%20to%20Github%20Releases&description=Generate%20draft%20release%20on%20GitHub%20with%20GitHub%20Actions%20I%20was%20trying%20to%20find%20a%20way%20to%20do%20GitHub%20releases%20with%20GitHub%20Actions%20or%20GitLab%20CI.%20When%20I%20happen%20to%20find%20semantic-release%20project.%20One%20of%20the%20benefits%20of%20GitHub%20Actions%20is%20that%20the%20majority%20of%20its%20users%20open%20source%20their%20workflows%20by%20default.%20I%20was%20able%20to%20kick%20start%20my%20workflow%20for%20keeping%20up%20with%20releases%20thanks%20to%20code%20from%20benmvp%2c%20a%20GitHub%20user%20and%20keynote%20speaker." aria-label=Tumblr>
<i class="fab fa-tumblr fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fdovh.cz%2fposts%2f2021-05-20-github-actions-automatic-release%2f&t=Automatic%20release%20drafting%20to%20Github%20Releases" aria-label="Hacker News">
<i class="fab fa-hacker-news fa-lg" aria-hidden=true></i>
</a>
</li>
</ul>
</div>
<div id=actions-footer>
<a id=menu-toggle class=icon href=# onclick="return $('#nav-footer').toggle(),!1" aria-label=Menu>
<i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick="return $('#toc-footer').toggle(),!1" aria-label=TOC>
<i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick="return $('#share-footer').toggle(),!1" aria-label=Share>
<i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast')" aria-label="Top of Page">
<i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a>
</div>
</div>
</div>
<footer id=footer>
<div class=footer-left>
Copyright &copy; 2021 dovh
</div>
<div class=footer-right>
<nav>
<ul>
<li><a href=/>Home</a></li>
<li><a href=/about>About</a></li>
<li><a href=/posts>Blog</a></li>
<li><a href=/tags>Topics</a></li>
</ul>
</nav>
</div>
</footer>
</div>
</body>
<link rel=stylesheet href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
<script src=/js/code-copy.js></script>
</html>